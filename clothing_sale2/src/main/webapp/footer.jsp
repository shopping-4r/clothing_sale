<%@ page language="java" contentType="text/html; charset=utf-8"
	pageEncoding="utf-8"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>
		<!-- footer area start-->
		<div class="footer-area ptb-50">
			<div class="container">
				<div class="row">
					<div class="col-lg-3 col-md-3 col-sm-4 col-xs-12">
						<div class="single-footer contact-us">
							<div class="footer-title uppercase">
								<h5>Contact US</h5>
							</div>
							<ul>
								<li>
									<div class="contact-icon">
										<i class="zmdi zmdi-pin-drop"></i>
									</div>
									<div class="contact-text">
										<p>
											<span>777/a Seventh Street,</span> <span>Rampura,
												Bonosri</span>
										</p>
									</div>
								</li>
								<li>
									<div class="contact-icon">
										<i class="zmdi zmdi-email-open"></i>
									</div>
									<div class="contact-text">
										<p>
											<span><a href="#">company@gmail.com</a></span> <span><a
												href="#">admin@devitems.com</a></span>
										</p>
									</div>
								</li>
								<li>
									<div class="contact-icon">
										<i class="zmdi zmdi-phone-paused"></i>
									</div>
									<div class="contact-text">
										<p>
											<span>+11 (019) 25184203</span> <span>+11 (018)
												50950555</span>
										</p>
									</div>
								</li>
							</ul>
						</div>
					</div>
					<div class="col-lg-2 col-md-2 col-sm-4 col-xs-12">
						<div class="single-footer informaton-area">
							<div class="footer-title uppercase">
								<h5>Information</h5>
							</div>
							<div class="informatoin">
								<ul>
									<li><a href="#">My Account</a></li>
									<li><a href="#">Order History</a></li>
									<li><a href="#">Wishlist</a></li>
									<li><a href="#">Returnes</a></li>
									<li><a href="#">Private Policy</a></li>
									<li><a href="#">Site Map</a></li>
								</ul>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-4 hidden-sm col-xs-12">
						<div class="single-footer instagrm-area">
							<div class="footer-title uppercase">
								<h5>InstaGram</h5>
							</div>
							<div class="instagrm">
								<ul>
									<li><a href="#"><img src="images/gallery/01.jpg"
											alt=""></a></li>
									<li><a href="#"><img src="images/gallery/02.jpg"
											alt=""></a></li>
									<li><a href="#"><img src="images/gallery/03.jpg"
											alt=""></a></li>
									<li><a href="#"><img src="images/gallery/04.jpg"
											alt=""></a></li>
									<li><a href="#"><img src="images/gallery/05.jpg"
											alt=""></a></li>
									<li><a href="#"><img src="images/gallery/06.jpg"
											alt=""></a></li>
								</ul>
							</div>
						</div>
					</div>
					<div class="col-lg-3 col-md-3 col-sm-4 col-lg-offset-1 col-xs-12">
						<div class="single-footer newslatter-area">
							<div class="footer-title uppercase">
								<h5>Get Newsletters</h5>
							</div>
							<div class="newslatter">
								<form action="#" method="post">
									<div class="input-box pos-rltv">
										<input placeholder="Type Your Email hear" type="text">
										<a href="#"> <i class="zmdi zmdi-arrow-right"></i>
										</a>
									</div>
								</form>
								<div class="social-icon socile-icon-style-3 mt-40">
									<div class="footer-title uppercase">
										<h5>Social Network</h5>
									</div>
									<ul>
										<li><a href="#"><i class="zmdi zmdi-facebook"></i></a></li>
										<li><a href="#"><i class="zmdi zmdi-linkedin"></i></a></li>
										<li><a href="#"><i class="zmdi zmdi-pinterest"></i></a></li>
										<li><a href="#"><i class="zmdi zmdi-google"></i></a></li>
										<li><a href="#"><i class="zmdi zmdi-twitter"></i></a></li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--footer area start-->

		<!--footer bottom area start-->
		<div class="footer-bottom global-table">
			<div class="global-row">
				<div class="global-cell">
					<div class="container">
						<div class="row">
							<div class="col-md-6 col-sm-6 col-xs-12">
								<div class="copyrigth">
									Copyright @ <a href="devitems.com">Devitems</a> All right
									reserved
								</div>
							</div>
							<div class="col-md-6 col-sm-6 col-xs-12">
								<ul class="payment-support text-right">
									<li><a href="#"><img src="images/icons/pay1.png"
											alt="" /></a></li>
									<li><a href="#"><img src="images/icons/pay2.png"
											alt="" /></a></li>
									<li><a href="#"><img src="images/icons/pay3.png"
											alt="" /></a></li>
									<li><a href="#"><img src="images/icons/pay4.png"
											alt="" /></a></li>
									<li><a href="#"><img src="images/icons/pay5.png"
											alt="" /></a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- QUICKVIEW PRODUCT -->
		<div id="quickview-wrapper">
			<!-- Modal -->
			<div class="modal fade" id="productModal" tabindex="-1" role="dialog">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal"
								aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body">
							<div class="modal-product">
								<div class="product-images">
									<!--modal tab start-->
									<div class="portfolio-thumbnil-area-2">
										<div class="tab-content active-portfolio-area-2">
											<div role="tabpanel" class="tab-pane active" id="view1">
												<div class="product-img">
													<img alt="Single portfolio" class="img1" />
												</div>
											</div>
											<div role="tabpanel" class="tab-pane" id="view2">
												<div class="product-img">
													<img alt="Single portfolio" class="img2" />
												</div>
											</div>
											<div role="tabpanel" class="tab-pane" id="view3">
												<div class="product-img">
													<img alt="Single portfolio" class="img3" />
												</div>
											</div>
											<div role="tabpanel" class="tab-pane" id="view4">
												<div class="product-img">
													<img alt="Single portfolio" class="img4" />
												</div>
											</div>
										</div>
										<div class="product-more-views-2">
											<div class="thumbnail-carousel-modal-2" data-tabs="tabs">
												<a href="#view1" aria-controls="view1" data-toggle="tab"><img
													src="images/product/01.jpg" alt="" /></a> <a href="#view2"
													aria-controls="view2" data-toggle="tab"><img
													src="images/product/02.jpg" alt="" /></a> <a href="#view3"
													aria-controls="view3" data-toggle="tab"><img
													src="images/product/03.jpg" alt="" /></a> <a href="#view4"
													aria-controls="view4" data-toggle="tab"><img
													src="images/product/04.jpg" alt="" /></a>
											</div>
										</div>
									</div>
								</div>
								<!--modal tab end-->
								<!-- .product-images -->
								<div class="product-info">
									<h1 id="product_name"></h1>
									<div class="price-box-3">
										<div class="s-price-box">
											<span class="new-price">$160.00</span> <span
												class="old-price">$190.00</span>
										</div>
									</div>
									<a href="shop.jsp" class="see-all">查看所有商品</a>
									<div class="single-product-option">
										<div class="sort product-type">
											<label>颜色: </label> <select id="input-sort-color"
												onchange="ajax1()">


											</select>
										</div>
										<div class="sort product-type">
											<label>尺寸: </label> <select id="input-sort-size"
												onchange="ajax1()">


											</select>
										</div>
									</div>
									<label>库存 :</label><label id="lab"> <c:choose>
											<c:when test="${empty count }">${goods.stock}</c:when>
											<c:otherwise>${count}</c:otherwise>
										</c:choose>
									</label>
									<div class="quantity-area">
										<label>数量 :</label>
										<div class="cart-quantity">
											<form action="" method="POST" id="myform">
												<div class="product-qty">
													<div class="cart-quantity">
														<div class="cart-plus-minus">
															<div class="dec qtybutton" onclick="jiancount();">-</div>
															<input id="iptCount" type="text" value="0"
																readonly="readonly" name="qtybutton"
																class="cart-plus-minus-box">
															<div class="inc qtybutton" onclick="addcount();">+</div>
														</div>
													</div>
												</div>
											</form>
										</div>

									</div>
									<div class="quick-add-to-cart">
										<button class="single_add_to_cart_button" onclick="addCart();">加入购物车</button>
									</div>
									<div class="quick-desc" id="feature">
									</div>
									<div class="social-sharing-modal">
										<div class="widget widget_socialsharing_widget">
											<h3 class="widget-title-modal">分享商品</h3>
											<ul class="social-icons-modal">
												<li><a target="_blank" title="Facebook" href="#"
													class="facebook m-single-icon"><i
														class="fa fa-facebook"></i></a></li>
												<li><a target="_blank" title="Twitter" href="#"
													class="twitter m-single-icon"><i class="fa fa-twitter"></i></a></li>
												<li><a target="_blank" title="Pinterest" href="#"
													class="pinterest m-single-icon"><i
														class="fa fa-pinterest"></i></a></li>
												<li><a target="_blank" title="Google +" href="#"
													class="gplus m-single-icon"><i
														class="fa fa-google-plus"></i></a></li>
												<li><a target="_blank" title="LinkedIn" href="#"
													class="linkedin m-single-icon"><i
														class="fa fa-linkedin"></i></a></li>
											</ul>
										</div>
									</div>
								</div>
								<!-- .product-info -->
							</div>
							<!-- .modal-product -->
						</div>
						<!-- .modal-body -->
					</div>
					<!-- .modal-content -->
				</div>
				<!-- .modal-dialog -->
			</div>
			<!-- END Modal -->
		</div>
		<!-- END QUICKVIEW PRODUCT -->
		</div>
		<!--footer bottom area end-->
	<!-- Body main wrapper end -->

	<!-- Placed js at the end of the document so the pages load faster -->

	<!-- jquery latest version -->
	<script src="js/vendor/jquery-1.12.0.min.js"></script>
	<!-- Bootstrap framework js -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Slider js -->
	<script src="js/slider/jquery.nivo.slider.pack.js"></script>
	<script src="js/slider/nivo-active.js"></script>
	<!-- counterUp-->
	<script src="js/jquery.countdown.min.js"></script>
	<!-- All js plugins included in this file. -->
	<script src="js/plugins.js"></script>
	<!-- Main js file that contents all jQuery plugins activation. -->
	<script src="js/main.js"></script>
<script type="text/javascript">
var count = "${goods.stock}";
//》》》》修改后的商品id
var scid;
var price1;
//显示商品详情的点击事件
function showInfo(gid){
		$.ajax({
		"url" : "single-product1.do",
		"type" : "post",
		"data" : {
			"id" : gid,
		},
		"dataType" : "json",
		"success" : function(obj) {
			if (obj != null) {
				$("#iptCount").val(0);
				count = 0;
				$("#lab").html(0);
				$("#input-sort-size").empty();
				$("#input-sort-color").empty();
				var images=obj[3];
				var goods=obj[0];
				var lstSize=obj[2];
				var lstColor=obj[1];
				console.log(images);
				$(".img1").attr("src","images/product/"+images[0]);
				$(".img2").attr("src","images/product/"+images[1]);
				$(".img3").attr("src","images/product/"+images[2]);
				$(".img4").attr("src","images/product/"+images[3]);
				$("#product_name").text(goods.name);
				price1=(goods.price*goods.rebate).toFixed(2);
				$("#new_price").text("$"+(goods.price*goods.rebate).toFixed(2));
				$("#old_price").text("$"+goods.price);
				$("#feature").html(goods.feature);	
				var sel1=$("#input-sort-size"); //根据id获取select的jquery对象
				sel1.append("<option value='1' selected='selected'>请选择尺寸</option>");
				for(var i=0;i<lstSize.length;i++){
					sel1.append("<option >"+lstSize[i]+"</option>");//添加option
				}
				var sel2=$("#input-sort-color"); 
				sel2.append("<option  value='1' selected='selected'>请选择颜色</option>");
				for(var i=0;i<lstColor.length;i++){
					sel2.append("<option >"+lstColor[i]+"</option>");//添加option
				}
			} else {
			}
		},
		"error" : function() {
		}
	});
};

function ajax1() {
	var obj1 = document.getElementById("input-sort-color");
	var index1 = obj1.selectedIndex;
	var color = obj1.options[index1].text;
	var obj = document.getElementById("input-sort-size");
	var index = obj.selectedIndex;
	var size = obj.options[index].text;
	var name=$("#product_name").html();
		$.ajax({
		"url" : "ajax1.do",
		"type" : "post",
		"data" : {
			"color" : color,
			"size" : size,
			"name" : name
		},
		"dataType" : "json",
		"success" : function(obj) {
			if (obj != null) {
				$("#iptCount").val(0);
				scid = obj.id;
				$("#inputscid").val(scid);
				count = obj.stock;
				$("#lab").html(obj.stock);
			} else {
				$("#iptCount").val(0);
				count = 0;
				$("#lab").html(0);
			}

		},
		"error" : function() {
		}
	});
}
//增加购买数量的点击事件
function addcount(){
    var oldVal =parseInt($("#iptCount").val());
    if(count>oldVal){
    	var newVal=oldVal+1;
    	$("#iptCount").val(newVal);
    	$("#inputcount").val($(newVal));
     }else{
        	alert("库存不足");
    }
} 
//减少购买数量的点击事件
	function jiancount(){
		var oldVal =parseInt($("#iptCount").val());
        if(oldVal>1){
        	var newVal=oldVal-1;
         	$("#iptCount").val(newVal);
         	$("#inputcount").val(newVal)
        }else{
        	$("#iptCount").val(1);
        }
   
    }
//删除购物车中的商品的点击事件
	function delHeaderCart(id,price,count){
 		var data={id:id};
 		if(confirm("你确定要删除吗？")){
 			 $.post("deleteCart.do",data,function(data){
	 			if(data){
	 				alert("删除成功") ;
	 				$("#total").text(parseInt($("#total").text())-1);
					$("#totalMoney").text(parseInt($("#totalMoney").text())-price*count);
					$("#"+"headerId_"+id).remove();
					$("#"+"theId_"+id).remove();
	 			}else{
	 				alert("删除失败");
	 			}
	 		});
 		};
 	};
//搜索栏的模糊查询
 	$(document).ready(function(){
        $("#single-input1").keyup(function(){//搜索
            var uname =$(this).val();
            if(uname.length >= 1){
                $.getJSON('search.do',{name:uname},function (data) {
                    var item;
                    $(".searchmore").empty();//清空原来的ul
                    if(data!=null){
                        $.each(data,function(i,res){//循环加入到ul中去
                        	if(i>=5) return false;
                        	item = "<a style='color:blue' href='single-product.do?id="+res.id+"&name="+res.name+"' style='color:blue'><li>"+res.name+"</li></a><br>";
                            $(".searchmore").append(item);
                        })
                        $(".searchmore").show();
                    }else{
                        $(".searchmore").hide();
                    }
                });
            }else{
                $(".searchmore").hide();
            }
        });
 });
      $(document).on("click", ".searchmore li", function(){
            $("#single-input1").val(trim($(this).text()));
            $(".searchmore").hide();
          });

        $(".input-box").mouseleave(function(){
             $(".searchmore").hide();
        });	
//添加到购物车的点击事件
function addCart(){
	var inputcount=$("#iptCount").val();
	if(inputcount==0||inputcount==null){
		alert("请选择商品数量");
		return;
	}
	var data={scid:scid,count:inputcount}
	$.post("ajax_addCart.do",data,function(data){
		var type=data.split("|~|");
		if(type[1]=="id"){
			console.log(type[0]);
			console.log(inputcount);
			var newcount=parseInt(inputcount)+parseInt($("#countId_"+type[0]).html());
			var price=parseFloat($.trim($("#priceId_"+type[0]).html()));
			$("#countId_"+type[0]).text(newcount);
			console.log(price);
			console.log(newcount);
			$("#totalMoney").text(parseFloat($("#totalMoney").text())+inputcount*price1);
		}else{
			$("#cart").prepend(type[0]);
			$("#total").text(parseInt($("#total").text())+1);
			console.log(price1);
			console.log(parseFloat($("#totalMoney").text()));
			$("#totalMoney").text(parseFloat($("#totalMoney").text())+inputcount*price1);
		}
	});
	alert("添加成功");
	$("#iptCount").val(0);
	count = 0;
	$("#lab").html(0);
	$("#input-sort-size").val(1);
	$("#input-sort-color").val(1);
}
</script>
</body>

</html>